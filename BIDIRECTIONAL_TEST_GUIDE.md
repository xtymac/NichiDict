# 双向搜索测试指南

## 🎯 现在可以测试的功能

NichiDict 现在支持**三个搜索方向**：

```
✅ 日文 → 英文/中文  （输入：食べる → 看到：to eat, 喫; 食）
✅ 英文 → 日文        （输入：eat → 看到：食べる, 喫する）
✅ 中文 → 日文        （输入：学校 → 看到：学校(がっこう)）
```

---

## 📱 在App中测试

### 测试1: 日文→英文/中文（原功能）

| 输入（日文） | 应该看到 |
|-------------|---------|
| `食べる` | ✅ to eat / 喫; 食 |
| `午後` | ✅ afternoon / 下午 |
| `学校` | ✅ school / 学校 |

### 测试2: 英文→日文（新功能）✨

| 输入（英文） | 应该看到（日文） |
|-------------|----------------|
| `eat` | ✅ 食べる, 喫する, 遣る 等 |
| `school` | ✅ 学校, いんたー 等 |
| `study` | ✅ 勉強, 遣る 等 |
| `water` | ✅ 水, お湯, お冷 等 |
| `afternoon` | ✅ 午後, お三時 等 |

### 测试3: 中文→日文（新功能）✨

| 输入（中文） | 应该看到（日文） |
|-------------|----------------|
| `学校` | ✅ 学校 (がっこう) |
| `学习` | ✅ 勉強 (べんきょう) |
| `下午` | ✅ 午後 (ごご), ひる |
| `水` | ✅ 水 (みず) |
| `中午` | ⚠️ 可能无结果（覆盖率限制）|

---

## 🔍 测试流程

### 快速验证（3分钟）

```
1. 打开App

2. 测试日文→中文：
   输入：食べる
   ✓ 看到中文翻译

3. 测试英文→日文：
   输入：eat
   ✓ 看到日文词条

4. 测试中文→日文：
   输入：学校
   ✓ 看到日文词条
```

### 完整测试（10分钟）

**Step 1: 日文输入**
```
食べる ✓
たべる ✓
taberu ✓
（应该都能找到同一个词）
```

**Step 2: 英文输入**
```
eat ✓
school ✓
study ✓
water ✓
afternoon ✓
```

**Step 3: 中文输入**
```
学校 ✓
学习 ✓
下午 ✓
水 ✓
```

**Step 4: 边界情况**
```
asdfgh → 无结果 ✓（正确）
123456 → 无结果 ✓（正确）
```

---

## 💡 理解搜索逻辑

### 智能搜索流程

```
用户输入
    ↓
检测输入类型
    ↓
├─ 包含日文字符（假名/汉字） → 正向搜索
│   └─ 查询 dictionary_fts
│
└─ 纯英文/中文字符 → 先正向，无结果则反向
    ├─ 先尝试：dictionary_fts
    └─ 无结果：reverse_search_fts
```

### 为什么有时候搜不到？

**情况1：中文词没结果**
```
输入：中午
结果：无结果
原因：数据库中该词无中文翻译
```

**解决方法**：
- 使用AI翻译功能
- 或尝试相关词（如"午後"）

**情况2：英文词太短**
```
输入：a
结果：可能很多无关结果
建议：输入完整单词
```

---

## 🛠️ 命令行测试

### 测试反向搜索功能

```bash
cd scripts
./test_reverse_search.sh
```

**输出示例**：
```
Test 1: English → Japanese
Query: 'eat'
  → 食べる (たべる)
  → 喫する (きっする)

Test 2: Chinese → Japanese
Query: '学校'
  → 学校 (がっこう)
```

### 交互查询工具

```bash
cd scripts
./query_word.sh

Query> eat
[显示日文结果]

Query> 学校
[显示日文结果]

Query> 食べる
[显示英文/中文结果]
```

---

## 📊 预期结果对照

### 英文查询覆盖率：100%

所有246,742个词条都有英文定义，因此：

| 输入类型 | 成功率 |
|---------|--------|
| 常见英文词 | ~100% |
| 专业术语 | ~80% |
| 俚语 | ~50% |

### 中文查询覆盖率：2.76%

只有6,809个词条有中文翻译，因此：

| 输入类型 | 成功率 |
|---------|--------|
| 常用词（JLPT N5-N3） | ~70% |
| 一般词汇 | ~30% |
| 专业术语 | ~5% |

---

## ❓ 常见问题

### Q1: 为什么输入"中午"找不到？

**A**: 数据库中该词没有中文翻译。

**试试这些**：
- 输入："午後"（日文） → 看到"下午"
- 输入："正午"（日文） → 可能有结果
- 使用AI翻译功能

### Q2: 输入"eat"为什么不显示"食べる"？

**A**: 应该会显示！如果没有：

1. 确认数据库已更新（86MB）
2. 重启App
3. 运行测试脚本验证：`./test_reverse_search.sh`

### Q3: 中文→日文结果太少？

**A**: 这是正常的，因为：

- 当前中文覆盖率：2.76%
- 主要覆盖常用词和JLPT词汇
- 未来会通过导入更多中文词典改进

### Q4: 如何区分查询方向？

**A**: App会自动判断：

```
输入"食べる" → 检测到日文字符 → 正向搜索
输入"eat"    → 检测到英文字符 → 反向搜索
输入"学校"   → 尝试正向，无果则反向
```

---

## ✅ 测试清单

### 功能测试

- [ ] 日文→英文查询正常
- [ ] 日文→中文查询正常
- [ ] 英文→日文查询正常
- [ ] 中文→日文查询正常
- [ ] 平假名输入正常
- [ ] 罗马字输入正常

### UI测试

- [ ] 搜索栏保持顶部（无结果时）
- [ ] 结果列表显示正常
- [ ] 详情页打开正常
- [ ] 加载指示器显示正常

### 边界测试

- [ ] 无结果时UI正确
- [ ] 特殊字符处理正常
- [ ] 空输入处理正常
- [ ] 过长输入处理正常

---

## 📈 测试数据

### 推荐测试词汇

**日文词（测试正向）**：
```
食べる, 今日, 学校, 午後, 勉強
行く, 来る, 見る, 水, 時間
```

**英文词（测试反向）**：
```
eat, school, study, water, afternoon
go, come, see, time, book
```

**中文词（测试反向）**：
```
学校, 学习, 下午, 水
去, 来, 看, 时间
```

---

## 🎯 成功标准

App达到以下标准即为成功：

✅ **基础功能**：
- 日文→英文/中文查询：100%工作
- 英文→日文查询：80%以上常用词可查到
- 中文→日文查询：70%以上常用词可查到

✅ **用户体验**：
- 查询速度<200ms
- 无明显卡顿
- 结果排序合理（常用词优先）

✅ **稳定性**：
- 无崩溃
- 无内存泄漏
- 数据库完整性检查通过

---

## 📚 相关文档

- [BIDIRECTIONAL_SEARCH_FEATURE.md](BIDIRECTIONAL_SEARCH_FEATURE.md) - 完整实现报告
- [APP_TESTING_GUIDE.md](APP_TESTING_GUIDE.md) - 通用测试指南
- [QUICK_TEST_REFERENCE.md](QUICK_TEST_REFERENCE.md) - 快速参考

---

**开始测试吧！** 🚀

如果遇到问题，请查看上述文档或运行测试脚本进行验证。
