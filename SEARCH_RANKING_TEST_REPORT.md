# 搜索排序测试报告

生成时间：2025-11-11

## 📊 词频数据统计

### 总体覆盖率
- **总词条数**：213,733
- **有词频数据的词条**：31,250 (14.6%)
- **无词频数据的词条**：182,483 (85.4%)

### 词频分布
| 频率范围 | 词条数 | 占比 | 说明 |
|---------|--------|------|------|
| 1-10 (超高频) | 3 | 0.001% | する、来る、いる |
| 11-100 (高频) | 0 | 0% | - |
| 101-500 (中高频) | 9,304 | 4.35% | JMdict 优先词 |
| 501-2,000 (中频) | 7,740 | 3.62% | 常用词 |
| >2,000 (低频) | 14,203 | 6.65% | 低频词 |
| 无词频 | 182,483 | 85.38% | 未标记词 |

### 数据来源
1. **JMdict 词频标记**：基于日本词典的优先级标记
   - news1/ichi1/spec1/gai1 → rank 1-1000
   - news2/ichi2/spec2/gai2 → rank 1001-5000
   - nf01-nf48 → rank 5001-50000

2. **Wikipedia 词频**：从日文维基百科语料中统计
   - 处理了 14,777 个词频条目
   - 更新了 6,475 个词条（采用更高的优先级）
   - 8,302 个 Wikipedia 词在词典中找不到

## 🧪 搜索排序测试用例

### Test 1: する（基本动词）
**预期**：完全匹配排第一，前缀匹配按词频排序

| 词条 | 读音 | 词频排名 | JLPT | 匹配类型 | 相关性得分 |
|-----|------|---------|------|---------|-----------|
| する | する | 1 | N5 | exact | 102 |
| すると | すると | 101 | N4 | prefix | 27 |
| するべき | するべき | 201 | - | prefix | 19 |

**结果**：✅ 完全匹配得分最高，前缀匹配按词频和 JLPT 排序

### Test 2: 好き（常用形容词）
**预期**：完全匹配排第一，派生词按重要性排序

| 词条 | 读音 | 词频排名 | JLPT | 匹配类型 | 相关性得分 |
|-----|------|---------|------|---------|-----------|
| 好き | すき | 101 | N5 | exact | 95 |
| 好き | ずき | - | N5 | exact | 90 |
| 好き好き | すきずき | 101 | N2 | prefix | 22 |
| 好き嫌い | すききらい | 2501 | N2 | prefix | 20 |
| 大好き | だいすき | 801 | N5 | contains | 18 |

**结果**：✅ 完全匹配优先，"大好き"（常用复合词）排在前列

### Test 3: 行く（基本动词）
**预期**：完全匹配排第一，过滤不相关的包含匹配

| 词条 | 读音 | 词频排名 | JLPT | 匹配类型 |
|-----|------|---------|------|---------|
| 行く | いく | 101 | N5 | exact |
| ばいく | ばいく | 101 | - | contains |
| まいく | まいく | 101 | - | contains |
| 教育 | きょういく | 101 | N4 | contains |

**结果**：⚠️ 完全匹配排第一，但有不相关的包含匹配（如"教育"）

## 📈 排序算法得分规则

### 1. 匹配类型得分
- **完全匹配（exact）**：+80 分
- **前缀匹配（prefix）**：+15 分
- **包含匹配（contains）**：+4 分

### 2. JLPT 等级加分
- **N5**：+10 分
- **N4**：+7 分
- **N3**：+4 分
- **N2**：+2 分

### 3. 词频加分（核心机制）
- **≤10**：+12 分（超高频）
- **11-30**：+9 分
- **31-50**：+7 分
- **51-200**：+5 分
- **201-1000**：+4 分
- **1001-5000**：+3 分

### 4. 词性加分
- **形容词/动词**：+5 分
- **普通名词**：+2 分

### 5. 长度惩罚
- 包含匹配：更强的长度惩罚（8x）
- 前缀匹配：标准长度惩罚（4x）

### 6. 专有名词惩罚
- **非完全匹配的专有名词**：-12 分

## 🎯 分组功能

### 装饰性分组（不影响排序，仅用于视觉组织）
1. **基本词**：完全匹配的结果
2. **常用表达**：有 JLPT 等级或词频 ≤ 200
3. **衍生词**：有词频但 > 200
4. **其他**：无词频数据

### 语义分组（用于高级 UI 组织）
1. 基本词汇 (Basic Vocabulary)
2. 派生形式 (Derivative Forms)
3. 复合词 (Compound Words)
4. 惯用句・谚语 (Idioms & Proverbs)
5. 专有名词 (Specialized Terms)

## 💡 改进建议

### 当前系统优势
✅ 词频数据覆盖最常用的 14.6% 词汇
✅ 完全匹配优先排序工作正常
✅ JLPT 和词频综合评分机制合理
✅ 分组功能完整实现

### 可优化的地方
1. **扩大词频覆盖**：可以继续导入更多 Wikipedia 数据
2. **过滤无关包含匹配**：如"教育"匹配"いく"（语义不相关）
3. **动态调整词频阈值**：根据实际使用情况优化得分区间

## 🚀 结论

**词频和分组功能已全面应用并正常工作！**

- 搜索结果按相关性得分排序
- 词频数据有效提升常用词排名
- 分组功能可用于视觉组织
- 排序算法综合考虑了匹配类型、词频、JLPT 等级等多个维度

**测试状态**：✅ 通过
